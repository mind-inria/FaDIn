Search.setIndex({"docnames": ["api", "auto_examples/index", "auto_examples/plot_multivariate_fadin", "auto_examples/plot_unhap", "auto_examples/plot_univariate_fadin", "auto_examples/sg_execution_times", "generated/fadin.kernels.DiscreteKernelFiniteSupport", "generated/fadin.solver.FaDIn", "index", "model", "sg_execution_times"], "filenames": ["api.rst", "auto_examples/index.rst", "auto_examples/plot_multivariate_fadin.rst", "auto_examples/plot_unhap.rst", "auto_examples/plot_univariate_fadin.rst", "auto_examples/sg_execution_times.rst", "generated/fadin.kernels.DiscreteKernelFiniteSupport.rst", "generated/fadin.solver.FaDIn.rst", "index.rst", "model.rst", "sg_execution_times.rst"], "titles": ["API Documentation", "Examples Gallery", "FaDIn on simulated 2-d Hawkes processes", "UNHaP on simulated univariate Hawkes processes", "FaDIn on simulated univariate Hawkes processes", "Computation times", "fadin.kernels.DiscreteKernelFiniteSupport", "fadin.solver.FaDIn", "FaDIn: Fast Discretized Inference of Hawkes Processes with General Parametric Kernels", "Model description", "Computation times"], "terms": {"some": [1, 9], "us": [1, 7, 8, 9], "fadin": [1, 3, 5, 10], "simul": [1, 5, 10], "univari": [1, 5, 10], "hawk": [1, 5, 6, 7, 10], "process": [1, 5, 6, 7, 10], "2": [1, 3, 4, 5, 8, 10], "d": [1, 5, 10], "unhap": [1, 5, 10], "download": [1, 2, 3, 4], "all": [1, 7, 10], "python": [1, 2, 3, 4], "sourc": [1, 2, 3, 4], "code": [1, 2, 3, 4], "auto_examples_python": 1, "zip": [1, 2, 3, 4], "jupyt": [1, 2, 3, 4], "notebook": [1, 2, 3, 4], "auto_examples_jupyt": 1, "gener": [1, 2, 3, 4, 6, 7, 9], "sphinx": [1, 2, 3, 4], "go": [2, 3, 4], "end": [2, 3, 4], "full": [2, 3, 4], "exampl": [2, 3, 4, 5, 8, 10], "thi": [2, 3, 4, 6, 8, 9], "demonstr": [2, 3, 4], "infer": [2, 3, 4, 7, 9], "perform": [2, 3, 4, 9], "multivari": [2, 9], "specif": [2, 4], "kernel": [2, 3, 4, 7], "author": [2, 3, 4], "guillaum": [2, 3, 4, 7, 8], "staerman": [2, 3, 4, 7, 8], "inria": [2, 3, 4], "fr": [2, 3, 4], "alexandr": [2, 4, 7, 8], "gramfort": [2, 4, 7, 8], "thoma": [2, 3, 4, 7, 8], "moreau": [2, 3, 4, 7, 8], "licens": [2, 3, 4], "mit": [2, 3, 4], "let": [2, 3, 4], "u": [2, 3, 4], "first": [2, 3, 4], "defin": [2, 3, 4, 6, 7, 9], "paramet": [2, 3, 4, 6, 7, 9], "our": [2, 3, 4], "model": [2, 3, 4, 8], "import": [2, 3, 4], "numpi": [2, 3, 4, 8], "np": [2, 3, 4], "torch": [2, 4, 8], "matplotlib": [2, 3, 4, 8], "pyplot": [2, 3, 4], "plt": [2, 3, 4], "patch": 2, "mpatch": 2, "from": [2, 3, 4, 5, 10], "util": [2, 3, 4], "utils_simu": [2, 3, 4], "simu_hawkes_clust": [2, 4], "solver": [2, 3, 4, 8, 9], "discretekernelfinitesupport": [2, 4], "n_dim": [2, 3, 4, 6, 7], "dt": [2, 4], "0": [2, 3, 4, 5, 6, 7, 8, 9, 10], "01": [2, 3, 4, 7], "t": [2, 4, 7, 9], "1_000_000": 2, "kernel_length": [2, 3, 4, 6, 7], "5": [2, 3, 4, 7], "l": [2, 4, 9], "int": [2, 4, 6, 7], "1": [2, 3, 4, 6, 7, 8], "size_grid": [2, 4], "discret": [2, 4, 6, 7], "linspac": [2, 4], "here": [2, 4], "we": [2, 4, 9], "set": [2, 4, 7, 9], "exponenti": [2, 4, 8, 9], "distribut": [2, 4, 9], "baselin": [2, 3, 4, 7, 9], "arrai": [2, 3, 4, 7], "alpha": [2, 3, 4, 7], "6": [2, 3, 4], "3": [2, 3, 4, 5, 7, 8, 10], "25": [2, 3, 4], "7": [2, 3, 4], "data": [2, 4, 8], "expon": [2, 4], "event": [2, 3, 4, 7, 8], "4": [2, 3, 4, 8], "8": [2, 3, 4], "9": [2, 3, 4], "10": [2, 3, 4], "11": [2, 3, 4], "12": [2, 3, 4, 8], "13": [2, 3, 4], "14": [2, 3, 4], "15": [2, 3, 4], "16": [2, 3, 4], "17": [2, 3, 4], "18": [2, 3, 4], "19": [2, 3, 4], "20": [2, 3, 4], "21": [2, 3, 4], "22": [2, 3, 4], "23": [2, 3, 4], "24": [2, 3, 4], "26": [2, 3, 4], "27": [2, 3, 4], "28": [2, 3, 4], "29": [2, 3, 4], "30": [2, 3, 4], "31": [2, 3, 4], "32": [2, 3, 4], "33": [2, 3, 4], "34": [2, 3, 4], "35": [2, 3, 4], "36": [2, 3, 4], "37": [2, 3, 4], "38": [2, 3, 4], "39": [2, 3, 4], "40": [2, 3, 4], "41": [2, 3, 4], "42": [2, 3, 4, 5, 10], "43": [2, 3, 4], "44": [2, 3, 4, 5, 10], "45": [2, 3, 4], "46": [2, 3, 4], "47": [2, 3, 4], "48": [2, 3, 4], "49": [2, 3, 4], "50": [2, 3, 4], "51": [2, 3, 4], "52": [2, 3, 4], "53": [2, 3, 4], "54": [2, 3, 4], "55": [2, 3, 4, 8], "56": [2, 3, 4, 5, 10], "57": [2, 3, 4], "58": [2, 3, 4], "59": [2, 3, 4], "60": [2, 3, 4], "61": [2, 3, 4], "62": [2, 3, 4], "63": [2, 3, 4], "64": [2, 3, 4], "65": [2, 3, 4], "66": [2, 3, 4], "67": [2, 3, 4], "68": [2, 3, 4], "69": [2, 3, 4], "70": [2, 3, 4], "71": [2, 3, 4], "72": [2, 3, 4], "73": [2, 3, 4], "74": [2, 3, 4], "75": [2, 3, 4], "76": [2, 3, 4], "77": [2, 3, 4], "78": [2, 3, 4], "79": [2, 3, 4], "80": [2, 3, 4], "81": [2, 3, 4], "82": [2, 3, 4], "83": [2, 3, 4], "84": [2, 3, 4], "85": [2, 3, 4], "86": [2, 3, 4], "87": [2, 3, 4], "88": [2, 3, 4], "89": [2, 3, 4], "90": [2, 3, 4], "91": [2, 3, 4], "92": [2, 3, 4], "93": [2, 3, 4], "94": [2, 3, 4], "95": [2, 3, 4], "96": [2, 3, 4], "97": [2, 3, 4], "98": [2, 3, 4], "99": [2, 3, 4], "100": [2, 3, 4], "101": [2, 3], "102": [2, 3], "103": [2, 3], "104": [2, 3], "105": [2, 3], "106": [2, 3], "107": [2, 3], "108": [2, 3], "109": [2, 3], "110": [2, 3], "111": [2, 3], "112": [2, 3], "113": [2, 3], "114": [2, 3], "115": [2, 3], "116": [2, 3], "117": [2, 3], "118": [2, 3], "119": [2, 3], "120": [2, 3], "121": [2, 3], "122": [2, 3], "123": [2, 3], "124": [2, 3], "125": [2, 3], "126": [2, 3], "127": [2, 3], "128": [2, 3], "129": [2, 3], "130": [2, 3], "131": [2, 3], "132": [2, 3], "133": [2, 3], "134": [2, 3], "135": [2, 3], "136": [2, 3], "137": [2, 3], "138": [2, 3], "139": [2, 3], "140": [2, 3], "appli": [2, 4], "truncated_exponenti": [2, 4, 6, 7], "delta": [2, 3, 4, 6, 7, 9], "optim": [2, 3, 4, 7, 9], "rmsprop": [2, 3, 4, 7], "params_optim": [2, 3, 4, 7], "lr": [2, 3, 4], "1e": [2, 3, 4, 7], "max_it": [2, 3, 4, 7], "10000": [2, 3], "fit": [2, 3, 4, 7], "averag": [2, 4], "last": [2, 4], "valu": [2, 4, 7], "estimated_baselin": [2, 4], "param_baselin": [2, 3, 4, 7], "mean": [2, 3, 4, 7], "estimated_alpha": [2, 4], "param_alpha": [2, 3, 4, 7], "param_kernel": [2, 3, 4, 7], "print": [2, 3, 4], "estim": [2, 3, 4, 7, 8, 9], "i": [2, 3, 4, 6, 7, 9], "truncat": [2, 3, 9], "number": [2, 3, 4, 7, 9], "3971403": 2, "4966295": 2, "precomput": [2, 3, 4, 7], "21320867538452": 2, "iter": [2, 3, 4, 7], "893904209136963": 2, "tensor": [2, 3, 4, 7], "1356": 2, "5145": 2, "6341": 2, "2653": 2, "2951": 2, "6604": 2, "0214": 2, "8846": 2, "1437": 2, "9893": 2, "plot": [2, 3, 4], "kernel_valu": [2, 4], "kernel_ev": [2, 4], "subplot": 2, "figsiz": 2, "rang": [2, 3], "j": [2, 7, 9], "exp": [2, 4, 9], "c": [2, 4], "k": [2, 4], "ylabel": [2, 4], "rf": 2, "phi_": [2, 7, 9], "size": [2, 3, 4, 6, 7, 9], "black_patch": 2, "facecolor": 2, "blue_patch": 2, "c0": 2, "label": [2, 3, 4], "true": [2, 3, 4, 7], "color": 2, "legend": [2, 4], "handl": 2, "loc": 2, "center": 2, "right": [2, 6, 9], "borderaxespad": 2, "fontsiz": [2, 4], "x": [2, 4], "larg": [2, 4], "suptitl": 2, "influenc": [2, 4], "show": [2, 3, 4], "github": 2, "workspac": 2, "plot_multivariate_fadin": [2, 5, 10], "py": [2, 3, 4, 5, 10], "matplotlibdeprecationwarn": 2, "auto": 2, "remov": 2, "overlap": 2, "ax": [2, 3], "deprec": 2, "sinc": 2, "two": 2, "minor": 2, "releas": 2, "later": 2, "explicitli": 2, "call": [2, 9], "need": [2, 8], "total": [2, 3, 4, 5, 10], "run": [2, 3, 4], "time": [2, 3, 4], "script": [2, 3, 4], "minut": [2, 3, 4], "597": [2, 5, 10], "second": [2, 3, 4], "ipynb": [2, 3, 4], "galleri": [2, 3, 4, 8, 10], "gaussian": [3, 9], "virgini": 3, "loison": 3, "simu_marked_hawkes_clust": 3, "custom_dens": 3, "simu_multi_poisson": 3, "function": [3, 6, 7, 9], "ident": 3, "linear_zero_on": 3, "reverse_linear_zero_on": 3, "truncated_gaussian": [3, 6, 7], "vi": 3, "baseline_nois": 3, "05": 3, "mu": 3, "sigma": 3, "end_tim": 3, "seed": 3, "20000": 3, "batch_rho": 3, "200": 3, "def": 3, "simulate_data": 3, "len": 3, "marks_kernel": 3, "marks_dens": 3, "time_kernel": 3, "params_marks_dens": 3, "dict": [3, 7], "scale": [3, 4], "params_marks_kernel": 3, "slope": 3, "params_time_kernel": 3, "marked_ev": 3, "_": [3, 9], "time_kernel_length": 3, "none": [3, 6, 7], "marks_kernel_length": 3, "random_st": [3, 7], "noisy_events_": 3, "random_mark": 3, "random": [3, 7], "rand": 3, "shape": [3, 7, 9], "noisy_mark": 3, "noisy_ev": 3, "concaten": 3, "reshap": 3, "axi": 3, "events_cat": 3, "argsort": 3, "zero": 3, "true_rho": 3, "put": 3, "mark": 3, "one": [3, 4], "test": 3, "impact": [3, 9], "return": 3, "ev": 3, "item": [3, 4], "141": 3, "142": 3, "143": 3, "144": 3, "145": 3, "146": 3, "147": 3, "148": 3, "149": 3, "150": 3, "151": 3, "152": 3, "153": 3, "154": 3, "155": 3, "density_hawk": 3, "linear": 3, "density_nois": 3, "uniform": 3, "moment_match": 3, "sum": [3, 7], "per": 3, "channel": 3, "49561": 3, "7422": 3, "74591": 3, "5620157718658447": 3, "329752683639526": 3, "object": 3, "0x7fcce890e700": 3, "sd": 3, "nois": 3, "param_baseline_nois": 3, "error": 3, "param": 3, "error_baselin": 3, "error_baseline_nois": 3, "error_alpha": 3, "error_mu": 3, "error_sigma": 3, "sum_error": 3, "error_param": 3, "sqrt": 3, "l2": [3, 7, 8], "squar": 3, "vector": [3, 7], "30654624104499817": 3, "4332163333892822": 3, "4043726921081543": 3, "10575250536203384": 3, "5540191531181335": 3, "5133590602874576": 3, "fig": 3, "plotfig": 3, "fals": [3, 7], "bl_nois": 3, "titl": [3, 4], "savefig": 3, "block": 3, "523": [3, 5, 10], "plot_unhap": [3, 5, 10], "10_000": 4, "an": [4, 8, 9], "beta": 4, "standard": 4, "equal": [4, 7], "params_kernel": 4, "2000": [4, 7], "19790": 4, "5259482860565186": 4, "5130956172943115": 4, "44591838121414185": 4, "7747589349746704": 4, "040663480758667": 4, "squeez": 4, "xlabel": 4, "r": 4, "phi": 4, "911": [4, 5, 10], "plot_univariate_fadin": [4, 5, 10], "03": [5, 10], "031": [5, 10], "execut": [5, 10], "file": [5, 10], "auto_exampl": 5, "mem": [5, 10], "mb": [5, 10], "02": [5, 10], "00": [5, 10], "04": [5, 10], "class": [6, 7], "lower": 6, "upper": 6, "grad_kernel": [6, 7], "A": [6, 9], "finit": [6, 8], "support": [6, 8], "float": [6, 7], "step": [6, 7], "dimens": [6, 7], "associ": 6, "str": [6, 7], "callabl": [6, 7], "either": [6, 7], "raised_cosin": [6, 7], "custom": [6, 7], "default": [6, 7], "length": [6, 7, 9], "left": [6, 9], "bound": 6, "It": [6, 9], "should": 6, "between": [6, 7], "w": [6, 9], "If": [6, 7, 8], "gradient": [6, 7, 8, 9], "implement": [6, 7, 9], "must": [6, 7], "given": [6, 7, 9], "method": [6, 7], "kernel_and_grad": 6, "__init__": [6, 7], "init": 7, "optim_mask": 7, "ztzg_approx": 7, "log": 7, "tol": 7, "0001": 7, "framework": [7, 9], "The": [7, 8, 9], "detail": 7, "c\u00e9dric": [7, 8], "allain": [7, 8], "fast": 7, "parametr": [7, 9], "http": [7, 8], "arxiv": [7, 8], "org": [7, 8], "ab": [7, 8], "2210": [7, 8], "04635": [7, 8], "minim": [7, 9], "loss": [7, 9], "intens": [7, 9], "convolut": 7, "ij": [7, 9], "dirac": 7, "z_i": 7, "sum_": [7, 9], "i_n": 7, "mathscr": [7, 9], "f": [7, 9], "i_t": 7, "delta_": 7, "locat": 7, "occurr": 7, "foral": 7, "dot": 7, "p": [7, 9], "quad": [7, 9], "lambda_i": [7, 9], "mu_i": [7, 9], "z_j": [7, 9], "where": [7, 8, 9], "ar": [7, 8, 9], "activ": 7, "grid": [7, 9], "underli": 7, "initi": 7, "strategi": 7, "randomli": 7, "moment_matching_max": 7, "moment": 7, "match": 7, "max": 7, "mode": 7, "moment_matching_mean": 7, "otherwis": 7, "dictionari": 7, "which": 7, "contain": 7, "follow": [7, 9], "kei": 7, "list": 7, "mask": 7, "same": 7, "coordin": [7, 9], "alpha_mask": 7, "adam": 7, "gd": 7, "algorithm": 7, "step_siz": 7, "learn": 7, "rate": 7, "chosen": 7, "1000": 7, "maximum": 7, "dure": 7, "boolean": 7, "comput": [7, 8], "ztzg": 7, "constant": 7, "bottleneck": 7, "approxim": 7, "toeplitz": 7, "matrix": 7, "take": 7, "account": 7, "edg": 7, "effect": 7, "record": 7, "toler": 7, "stop": 7, "when": 7, "criterion": 7, "below": 7, "reach": 7, "doe": 7, "attribut": 7, "weight": 7, "vari": 7, "depend": 7, "each": [7, 9], "v_loss": 7, "n_iter": 7, "accross": 7, "earli": 7, "offici": 8, "librari": [8, 9], "while": 8, "more": 8, "effici": [8, 9], "relev": 8, "certain": 8, "applic": 8, "immedi": 8, "trigger": 8, "thei": 8, "ill": 8, "suit": 8, "latenc": 8, "neurosci": 8, "work": 8, "aim": 8, "offer": 8, "solut": 8, "tpp": 8, "develop": 8, "consist": 8, "base": [8, 9], "leverag": 8, "version": [8, 9], "To": 8, "do": 8, "pip": 8, "you": 8, "have": [8, 9], "admin": 8, "privileg": 8, "user": 8, "flag": 8, "upgrad": 8, "provid": 8, "These": [8, 9], "scipi": 8, "numba": 8, "icml": 8, "2023": 8, "descript": 8, "api": 8, "document": 8, "allow": 9, "ani": 9, "ell_2": 9, "content": 9, "dimension": 9, "count": 9, "n": 9, "n_1": 9, "cdot": 9, "n_p": 9, "n_i": 9, "geq": 9, "mathbf": 9, "1_": 9, "t_": 9, "leq": 9, "ldot": 9, "being": 9, "tick": 9, "timestamp": 9, "observ": 9, "compon": 9, "element": 9, "induc": 9, "anoth": 9, "encod": 9, "In": 9, "abov": 9, "formula": 9, "note": 9, "differ": 9, "choic": 9, "correspond": 9, "usual": 9, "limit": 9, "neural": 9, "network": 9, "non": 9, "wai": 9, "pre": 9, "_t": 9, "t_1": 9, "mathcal": 9, "g": 9, "obtain": 9, "project": 9, "onto": 9, "denot": 9, "tild": 9, "_1": 9, "therefor": 9, "lambda": 9, "_i": 9, "": 9, "underbrac": 9, "tau": 9, "lfloor": 9, "frac": 9, "rfloor": 9, "eta_": 9, "introduc": 9, "precis": 9, "n_t": 9, "_n": 9, "involv": 9, "packag": 9, "three": 9, "rais": 9, "cosin": 9, "alpha_": 9, "co": 9, "u_": 9, "sigma_": 9, "pi": 9, "triplet": 9, "m_": 9, "mathbb": 9, "cdf": 9, "beta_": 9, "h": 9, "doublet": 9}, "objects": {"fadin.kernels": [[6, 0, 1, "", "DiscreteKernelFiniteSupport"]], "fadin.kernels.DiscreteKernelFiniteSupport": [[6, 1, 1, "", "__init__"]], "fadin.solver": [[7, 0, 1, "", "FaDIn"]], "fadin.solver.FaDIn": [[7, 1, 1, "", "__init__"]]}, "objtypes": {"0": "py:class", "1": "py:method"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"]}, "titleterms": {"api": 0, "document": 0, "solver": [0, 7], "finit": [0, 9], "support": [0, 9], "kernel": [0, 6, 8, 9], "exampl": 1, "galleri": 1, "fadin": [2, 4, 6, 7, 8, 9], "simul": [2, 3, 4], "2": [2, 9], "d": 2, "hawk": [2, 3, 4, 8, 9], "process": [2, 3, 4, 8, 9], "unhap": 3, "univari": [3, 4], "comput": [5, 10], "time": [5, 10], "discretekernelfinitesupport": 6, "fast": 8, "discret": [8, 9], "infer": 8, "gener": 8, "parametr": 8, "instal": 8, "depend": 8, "cite": 8, "content": 8, "model": 9, "descript": 9, "1": 9, "3": 9, "4": 9}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 58}, "alltitles": {"API Documentation": [[0, "api-documentation"]], "Solver": [[0, "solver"]], "Finite-support Kernels": [[0, "finite-support-kernels"]], "Examples Gallery": [[1, "examples-gallery"]], "FaDIn on simulated 2-d Hawkes processes": [[2, "fadin-on-simulated-2-d-hawkes-processes"]], "UNHaP on simulated univariate Hawkes processes": [[3, "unhap-on-simulated-univariate-hawkes-processes"]], "FaDIn on simulated univariate Hawkes processes": [[4, "fadin-on-simulated-univariate-hawkes-processes"]], "Computation times": [[5, "computation-times"], [10, "computation-times"]], "fadin.kernels.DiscreteKernelFiniteSupport": [[6, "fadin-kernels-discretekernelfinitesupport"]], "fadin.solver.FaDIn": [[7, "fadin-solver-fadin"]], "FaDIn: Fast Discretized Inference of Hawkes Processes with General Parametric Kernels": [[8, "fadin-fast-discretized-inference-of-hawkes-processes-with-general-parametric-kernels"]], "Installation": [[8, "installation"]], "Dependencies": [[8, "dependencies"]], "Cite": [[8, "cite"]], "Contents": [[8, "contents"]], "Model description": [[9, "model-description"]], "1. Hawkes process": [[9, "hawkes-process"]], "2. Discretization and finite-support kernels": [[9, "discretization-and-finite-support-kernels"]], "3. FaDIn": [[9, "fadin"]], "4. Kernels": [[9, "kernels"]]}, "indexentries": {"discretekernelfinitesupport (class in fadin.kernels)": [[6, "fadin.kernels.DiscreteKernelFiniteSupport"]], "__init__() (fadin.kernels.discretekernelfinitesupport method)": [[6, "fadin.kernels.DiscreteKernelFiniteSupport.__init__"]], "fadin (class in fadin.solver)": [[7, "fadin.solver.FaDIn"]], "__init__() (fadin.solver.fadin method)": [[7, "fadin.solver.FaDIn.__init__"]]}})