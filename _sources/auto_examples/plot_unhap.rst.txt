
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_unhap.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_unhap.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_unhap.py:


==============================================
UNHaP on simulated univariate Hawkes processes
==============================================

This example demonstrates inference performed
by UNHaP on univariate Hawkes processes simulated
with a truncated gaussian kernel.

.. GENERATED FROM PYTHON SOURCE LINES 10-17

.. code-block:: Python


    # Authors: Guillaume Staerman <guillaume.staerman@inria.fr>
    #          Virginie Loison <virginie.loison@inria.fr>
    #          Thomas Moreau <thomas.moreau@inria.fr>
    #
    # License: MIT








.. GENERATED FROM PYTHON SOURCE LINES 18-20

Let us first define the parameters of our model.
%% Imports

.. GENERATED FROM PYTHON SOURCE LINES 20-28

.. code-block:: Python

    import numpy as np
    import matplotlib.pyplot as plt

    from fadin.utils.utils_simu import simulate_marked_data
    from fadin.solver import UNHaP
    from fadin.utils.vis import plot









.. GENERATED FROM PYTHON SOURCE LINES 29-42

.. code-block:: Python


    baseline = np.array([0.3])
    baseline_noise = np.array([0.05])
    alpha = np.array([[1.45]])
    mu = np.array([[0.4]])
    sigma = np.array([[0.1]])

    delta = 0.01
    end_time = 1000
    seed = 0
    max_iter = 2000
    batch_rho = 200








.. GENERATED FROM PYTHON SOURCE LINES 43-48

.. code-block:: Python


    ev, noisy_marks, true_rho = simulate_marked_data(
        baseline, baseline_noise.item(), alpha, end_time, mu, sigma, seed=0
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Simulate generation 0
    Simulate generation 1
    Simulate generation 2
    Simulate generation 3
    Simulate generation 4
    Simulate generation 5
    Simulate generation 6
    Simulate generation 7
    Simulate generation 8
    Simulate generation 9
    Simulate generation 10
    Simulate generation 11
    Simulate generation 12
    Simulate generation 13
    Simulate generation 14
    Simulate generation 15
    Simulate generation 16
    Simulate generation 17
    Simulate generation 18
    Simulate generation 19
    Simulate generation 20
    Simulate generation 21
    Simulate generation 22
    Simulate generation 23
    Simulate generation 24
    Simulate generation 25
    Simulate generation 26
    Simulate generation 27
    Simulate generation 28
    Simulate generation 29
    Simulate generation 30
    Simulate generation 31
    Simulate generation 32
    Simulate generation 33
    Simulate generation 34
    Simulate generation 35
    Simulate generation 36
    Simulate generation 37
    Simulate generation 38
    Simulate generation 39
    Simulate generation 40
    Simulate generation 41
    Simulate generation 42
    Simulate generation 43
    Simulate generation 44
    Simulate generation 45
    Simulate generation 46
    Simulate generation 47
    Simulate generation 48
    Simulate generation 49
    Simulate generation 50
    Simulate generation 51
    Simulate generation 52
    Simulate generation 53
    Simulate generation 54
    Simulate generation 55




.. GENERATED FROM PYTHON SOURCE LINES 49-62

.. code-block:: Python

    print('Type of ev object', type(ev))
    # ev is a list of numpy arrays, one for each dimension
    print('Number of events', len(ev[0]))
    print('Shape of first event array', ev[0].shape)
    # Each dimension is stored as a numpy array of shape (n_events, 2).
    print('First 10 events timestamps and marks', ev[0][:10])
    # Each event is stored as [timestamp, mark].
    # This is the expected data format for UNHaP.
    print('First event timestamp', ev[0][0][0])
    print('First event mark', ev[0][0][1])
    print('Second event timestamp', ev[0][1][0])
    print('Second event mark', ev[0][1][1])





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Type of ev object <class 'list'>
    Number of events 4051
    Shape of first event array (4051, 2)
    First 10 events timestamps and marks [[ 4.69547619  0.74068982]
     [11.71408419  0.84561144]
     [13.23685776  0.7762665 ]
     [13.64455959  0.32854968]
     [13.92911594  0.52535543]
     [14.34636819  0.70410709]
     [14.91771101  0.86337427]
     [16.42962959  0.73803117]
     [18.52179446  0.6507131 ]
     [18.78980044  0.80357712]]
    First event timestamp 4.695476192547066
    First event mark 0.7406898228281054
    Second event timestamp 11.714084185001973
    Second event mark 0.8456114395619337




.. GENERATED FROM PYTHON SOURCE LINES 63-79

.. code-block:: Python


    solver = UNHaP(
        n_dim=1,
        kernel="truncated_gaussian",
        kernel_length=1.0,
        init='moment_matching_mean',
        delta=delta,
        optim="RMSprop",
        params_optim={"lr": 1e-3},
        max_iter=max_iter,
        batch_rho=batch_rho,
        density_hawkes="linear",
        density_noise="uniform",
    )
    solver.fit(ev, end_time)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    sum of marks per channel: tensor([2465.4731])
    number of events is: tensor([3721.])
    precomput: 0.5338568687438965
    Fitting model...   0.0%    Fitting model...   0.1%    Fitting model...   0.1%    Fitting model...   0.1%    Fitting model...   0.2%    Fitting model...   0.2%    Fitting model...   0.3%    Fitting model...   0.4%    Fitting model...   0.4%    Fitting model...   0.4%    Fitting model...   0.5%    Fitting model...   0.5%    Fitting model...   0.6%    Fitting model...   0.7%    Fitting model...   0.7%    Fitting model...   0.8%    Fitting model...   0.8%    Fitting model...   0.9%    Fitting model...   0.9%    Fitting model...   0.9%    Fitting model...   1.0%    Fitting model...   1.1%    Fitting model...   1.1%    Fitting model...   1.1%    Fitting model...   1.2%    Fitting model...   1.2%    Fitting model...   1.3%    Fitting model...   1.4%    Fitting model...   1.4%    Fitting model...   1.5%    Fitting model...   1.5%    Fitting model...   1.6%    Fitting model...   1.6%    Fitting model...   1.7%    Fitting model...   1.7%    Fitting model...   1.8%    Fitting model...   1.8%    Fitting model...   1.8%    Fitting model...   1.9%    Fitting model...   1.9%    Fitting model...   2.0%    Fitting model...   2.1%    Fitting model...   2.1%    Fitting model...   2.1%    Fitting model...   2.2%    Fitting model...   2.2%    Fitting model...   2.3%    Fitting model...   2.4%    Fitting model...   2.4%    Fitting model...   2.5%    Fitting model...   2.5%    Fitting model...   2.5%    Fitting model...   2.6%    Fitting model...   2.6%    Fitting model...   2.7%    Fitting model...   2.8%    Fitting model...   2.8%    Fitting model...   2.9%    Fitting model...   2.9%    Fitting model...   2.9%    Fitting model...   3.0%    Fitting model...   3.0%    Fitting model...   3.1%    Fitting model...   3.1%    Fitting model...   3.2%    Fitting model...   3.2%    Fitting model...   3.3%    Fitting model...   3.4%    Fitting model...   3.4%    Fitting model...   3.5%    Fitting model...   3.5%    Fitting model...   3.5%    Fitting model...   3.6%    Fitting model...   3.6%    Fitting model...   3.7%    Fitting model...   3.8%    Fitting model...   3.8%    Fitting model...   3.9%    Fitting model...   3.9%    Fitting model...   4.0%    Fitting model...   4.0%    Fitting model...   4.0%    Fitting model...   4.1%    Fitting model...   4.2%    Fitting model...   4.2%    Fitting model...   4.2%    Fitting model...   4.3%    Fitting model...   4.3%    Fitting model...   4.4%    Fitting model...   4.5%    Fitting model...   4.5%    Fitting model...   4.5%    Fitting model...   4.6%    Fitting model...   4.7%    Fitting model...   4.7%    Fitting model...   4.8%    Fitting model...   4.8%    Fitting model...   4.9%    Fitting model...   4.9%    Fitting model...   5.0%    Fitting model...   5.0%    Fitting model...   5.1%    Fitting model...   5.1%    Fitting model...   5.1%    Fitting model...   5.2%    Fitting model...   5.2%    Fitting model...   5.3%    Fitting model...   5.3%    Fitting model...   5.4%    Fitting model...   5.5%    Fitting model...   5.5%    Fitting model...   5.5%    Fitting model...   5.6%    Fitting model...   5.7%    Fitting model...   5.7%    Fitting model...   5.8%    Fitting model...   5.8%    Fitting model...   5.9%    Fitting model...   5.9%    Fitting model...   5.9%    Fitting model...   6.0%    Fitting model...   6.0%    Fitting model...   6.1%    Fitting model...   6.2%    Fitting model...   6.2%    Fitting model...   6.2%    Fitting model...   6.3%    Fitting model...   6.3%    Fitting model...   6.4%    Fitting model...   6.5%    Fitting model...   6.5%    Fitting model...   6.6%    Fitting model...   6.6%    Fitting model...   6.7%    Fitting model...   6.7%    Fitting model...   6.8%    Fitting model...   6.8%    Fitting model...   6.9%    Fitting model...   6.9%    Fitting model...   7.0%    Fitting model...   7.0%    Fitting model...   7.0%    Fitting model...   7.1%    Fitting model...   7.1%    Fitting model...   7.2%    Fitting model...   7.2%    Fitting model...   7.3%    Fitting model...   7.3%    Fitting model...   7.4%    Fitting model...   7.4%    Fitting model...   7.5%    Fitting model...   7.5%    Fitting model...   7.6%    Fitting model...   7.6%    Fitting model...   7.7%    Fitting model...   7.8%    Fitting model...   7.8%    Fitting model...   7.8%    Fitting model...   7.9%    Fitting model...   8.0%    Fitting model...   8.0%    Fitting model...   8.1%    Fitting model...   8.1%    Fitting model...   8.2%    Fitting model...   8.2%    Fitting model...   8.2%    Fitting model...   8.3%    Fitting model...   8.3%    Fitting model...   8.4%    Fitting model...   8.5%    Fitting model...   8.5%    Fitting model...   8.6%    Fitting model...   8.6%    Fitting model...   8.6%    Fitting model...   8.7%    Fitting model...   8.8%    Fitting model...   8.8%    Fitting model...   8.8%    Fitting model...   8.9%    Fitting model...   8.9%    Fitting model...   9.0%    Fitting model...   9.0%    Fitting model...   9.1%    Fitting model...   9.2%    Fitting model...   9.2%    Fitting model...   9.2%    Fitting model...   9.3%    Fitting model...   9.3%    Fitting model...   9.4%    Fitting model...   9.4%    Fitting model...   9.5%    Fitting model...   9.6%    Fitting model...   9.6%    Fitting model...   9.7%    Fitting model...   9.7%    Fitting model...   9.8%    Fitting model...   9.8%    Fitting model...   9.8%    Fitting model...   9.9%    Fitting model...  10.0%    Fitting model...  10.0%    Fitting model...  10.1%    Fitting model...  10.1%    Fitting model...  10.2%    Fitting model...  10.2%    Fitting model...  10.2%    Fitting model...  10.3%    Fitting model...  10.3%    Fitting model...  10.4%    Fitting model...  10.4%    Fitting model...  10.5%    Fitting model...  10.5%    Fitting model...  10.6%    Fitting model...  10.7%    Fitting model...  10.7%    Fitting model...  10.8%    Fitting model...  10.8%    Fitting model...  10.8%    Fitting model...  10.9%    Fitting model...  10.9%    Fitting model...  11.0%    Fitting model...  11.1%    Fitting model...  11.1%    Fitting model...  11.2%    Fitting model...  11.2%    Fitting model...  11.2%    Fitting model...  11.3%    Fitting model...  11.3%    Fitting model...  11.4%    Fitting model...  11.5%    Fitting model...  11.5%    Fitting model...  11.6%    Fitting model...  11.6%    Fitting model...  11.7%    Fitting model...  11.7%    Fitting model...  11.8%    Fitting model...  11.8%    Fitting model...  11.8%    Fitting model...  11.9%    Fitting model...  11.9%    Fitting model...  12.0%    Fitting model...  12.0%    Fitting model...  12.1%    Fitting model...  12.2%    Fitting model...  12.2%    Fitting model...  12.2%    Fitting model...  12.3%    Fitting model...  12.3%    Fitting model...  12.4%    Fitting model...  12.4%    Fitting model...  12.5%    Fitting model...  12.6%    Fitting model...  12.6%    Fitting model...  12.7%    Fitting model...  12.7%    Fitting model...  12.8%    Fitting model...  12.8%    Fitting model...  12.8%    Fitting model...  12.9%    Fitting model...  13.0%    Fitting model...  13.0%    Fitting model...  13.1%    Fitting model...  13.1%    Fitting model...  13.2%    Fitting model...  13.2%    Fitting model...  13.2%    Fitting model...  13.3%    Fitting model...  13.4%    Fitting model...  13.4%    Fitting model...  13.5%    Fitting model...  13.5%    Fitting model...  13.6%    Fitting model...  13.6%    Fitting model...  13.7%    Fitting model...  13.7%    Fitting model...  13.8%    Fitting model...  13.8%    Fitting model...  13.9%    Fitting model...  13.9%    Fitting model...  14.0%    Fitting model...  14.0%    Fitting model...  14.1%    Fitting model...  14.1%    Fitting model...  14.1%    Fitting model...  14.2%    Fitting model...  14.2%    Fitting model...  14.3%    Fitting model...  14.3%    Fitting model...  14.4%    Fitting model...  14.4%    Fitting model...  14.5%    Fitting model...  14.5%    Fitting model...  14.6%    Fitting model...  14.6%    Fitting model...  14.7%    Fitting model...  14.8%    Fitting model...  14.8%    Fitting model...  14.8%    Fitting model...  14.9%    Fitting model...  14.9%    Fitting model...  15.0%    Fitting model...  15.0%    Fitting model...  15.1%    Fitting model...  15.2%    Fitting model...  15.2%    Fitting model...  15.2%    Fitting model...  15.3%    Fitting model...  15.3%    Fitting model...  15.4%    Fitting model...  15.4%    Fitting model...  15.5%    Fitting model...  15.6%    Fitting model...  15.6%    Fitting model...  15.7%    Fitting model...  15.7%    Fitting model...  15.8%    Fitting model...  15.8%    Fitting model...  15.8%    Fitting model...  15.9%    Fitting model...  16.0%    Fitting model...  16.0%    Fitting model...  16.1%    Fitting model...  16.1%    Fitting model...  16.2%    Fitting model...  16.2%    Fitting model...  16.2%    Fitting model...  16.3%    Fitting model...  16.4%    Fitting model...  16.4%    Fitting model...  16.4%    Fitting model...  16.5%    Fitting model...  16.6%    Fitting model...  16.6%    Fitting model...  16.7%    Fitting model...  16.7%    Fitting model...  16.8%    Fitting model...  16.8%    Fitting model...  16.9%    Fitting model...  16.9%    Fitting model...  17.0%    Fitting model...  17.0%    Fitting model...  17.1%    Fitting model...  17.1%    Fitting model...  17.2%    Fitting model...  17.2%    Fitting model...  17.2%    Fitting model...  17.3%    Fitting model...  17.3%    Fitting model...  17.4%    Fitting model...  17.4%    Fitting model...  17.5%    Fitting model...  17.5%    Fitting model...  17.6%    Fitting model...  17.6%    Fitting model...  17.7%    Fitting model...  17.8%    Fitting model...  17.8%    Fitting model...  17.8%    Fitting model...  17.9%    Fitting model...  17.9%    Fitting model...  18.0%    Fitting model...  18.1%    Fitting model...  18.1%    Fitting model...  18.1%    Fitting model...  18.2%    Fitting model...  18.2%    Fitting model...  18.3%    Fitting model...  18.4%    Fitting model...  18.4%    Fitting model...  18.4%    Fitting model...  18.5%    Fitting model...  18.6%    Fitting model...  18.6%    Fitting model...  18.6%    Fitting model...  18.7%    Fitting model...  18.8%    Fitting model...  18.8%    Fitting model...  18.9%    Fitting model...  18.9%    Fitting model...  18.9%    Fitting model...  19.0%    Fitting model...  19.1%    Fitting model...  19.1%    Fitting model...  19.1%    Fitting model...  19.2%    Fitting model...  19.2%    Fitting model...  19.3%    Fitting model...  19.4%    Fitting model...  19.4%    Fitting model...  19.4%    Fitting model...  19.5%    Fitting model...  19.6%    Fitting model...  19.6%    Fitting model...  19.7%    Fitting model...  19.7%    Fitting model...  19.8%    Fitting model...  19.8%    Fitting model...  19.9%    Fitting model...  19.9%    Fitting model...  20.0%    Fitting model...  20.0%    Fitting model...  20.1%    Fitting model...  20.1%    Fitting model...  20.2%    Fitting model...  20.2%    Fitting model...  20.2%    Fitting model...  20.3%    Fitting model...  20.3%    Fitting model...  20.4%    Fitting model...  20.4%    Fitting model...  20.5%    Fitting model...  20.5%    Fitting model...  20.6%    Fitting model...  20.6%    Fitting model...  20.7%    Fitting model...  20.8%    Fitting model...  20.8%    Fitting model...  20.8%    Fitting model...  20.9%    Fitting model...  20.9%    Fitting model...  21.0%    Fitting model...  21.1%    Fitting model...  21.1%    Fitting model...  21.1%    Fitting model...  21.2%    Fitting model...  21.2%    Fitting model...  21.3%    Fitting model...  21.3%    Fitting model...  21.4%    Fitting model...  21.4%    Fitting model...  21.5%    Fitting model...  21.6%    Fitting model...  21.6%    Fitting model...  21.6%    Fitting model...  21.7%    Fitting model...  21.8%    Fitting model...  21.8%    Fitting model...  21.9%    Fitting model...  21.9%    Fitting model...  21.9%    Fitting model...  22.0%    Fitting model...  22.1%    Fitting model...  22.1%    Fitting model...  22.1%    Fitting model...  22.2%    Fitting model...  22.2%    Fitting model...  22.3%    Fitting model...  22.4%    Fitting model...  22.4%    Fitting model...  22.4%    Fitting model...  22.5%    Fitting model...  22.6%    Fitting model...  22.6%    Fitting model...  22.7%    Fitting model...  22.7%    Fitting model...  22.8%    Fitting model...  22.8%    Fitting model...  22.9%    Fitting model...  22.9%    Fitting model...  22.9%    Fitting model...  23.0%    Fitting model...  23.1%    Fitting model...  23.1%    Fitting model...  23.2%    Fitting model...  23.2%    Fitting model...  23.2%    Fitting model...  23.3%    Fitting model...  23.4%    Fitting model...  23.4%    Fitting model...  23.4%    Fitting model...  23.5%    Fitting model...  23.5%    Fitting model...  23.6%    Fitting model...  23.6%    Fitting model...  23.7%    Fitting model...  23.8%    Fitting model...  23.8%    Fitting model...  23.8%    Fitting model...  23.9%    Fitting model...  23.9%    Fitting model...  24.0%    Fitting model...  24.1%    Fitting model...  24.1%    Fitting model...  24.1%    Fitting model...  24.2%    Fitting model...  24.2%    Fitting model...  24.3%    Fitting model...  24.3%    Fitting model...  24.4%    Fitting model...  24.4%    Fitting model...  24.5%    Fitting model...  24.6%    Fitting model...  24.6%    Fitting model...  24.6%    Fitting model...  24.7%    Fitting model...  24.8%    Fitting model...  24.8%    Fitting model...  24.9%    Fitting model...  24.9%    Fitting model...  24.9%    Fitting model...  25.0%    Fitting model...  25.1%    Fitting model...  25.1%    Fitting model...  25.1%    Fitting model...  25.2%    Fitting model...  25.2%    Fitting model...  25.3%    Fitting model...  25.4%    Fitting model...  25.4%    Fitting model...  25.4%    Fitting model...  25.5%    Fitting model...  25.6%    Fitting model...  25.6%    Fitting model...  25.7%    Fitting model...  25.7%    Fitting model...  25.8%    Fitting model...  25.8%    Fitting model...  25.9%    Fitting model...  25.9%    Fitting model...  25.9%    Fitting model...  26.0%    Fitting model...  26.1%    Fitting model...  26.1%    Fitting model...  26.2%    Fitting model...  26.2%    Fitting model...  26.2%    Fitting model...  26.3%    Fitting model...  26.4%    Fitting model...  26.4%    Fitting model...  26.5%    Fitting model...  26.5%    Fitting model...  26.6%    Fitting model...  26.6%    Fitting model...  26.7%    Fitting model...  26.7%    Fitting model...  26.8%    Fitting model...  26.8%    Fitting model...  26.9%    Fitting model...  26.9%    Fitting model...  27.0%    Fitting model...  27.0%    Fitting model...  27.1%    Fitting model...  27.1%    Fitting model...  27.2%    Fitting model...  27.2%    Fitting model...  27.3%    Fitting model...  27.3%    Fitting model...  27.4%    Fitting model...  27.4%    Fitting model...  27.5%    Fitting model...  27.5%    Fitting model...  27.6%    Fitting model...  27.6%    Fitting model...  27.7%    Fitting model...  27.7%    Fitting model...  27.8%    Fitting model...  27.8%    Fitting model...  27.9%    Fitting model...  27.9%    Fitting model...  28.0%    Fitting model...  28.0%    Fitting model...  28.1%    Fitting model...  28.1%    Fitting model...  28.1%    Fitting model...  28.2%    Fitting model...  28.2%    Fitting model...  28.3%    Fitting model...  28.3%    Fitting model...  28.4%    Fitting model...  28.4%    Fitting model...  28.5%    Fitting model...  28.5%    Fitting model...  28.6%    Fitting model...  28.6%    Fitting model...  28.7%    Fitting model...  28.7%    Fitting model...  28.8%    Fitting model...  28.8%    Fitting model...  28.9%    Fitting model...  28.9%    Fitting model...  29.0%    Fitting model...  29.0%    Fitting model...  29.1%    Fitting model...  29.1%    Fitting model...  29.2%    Fitting model...  29.2%    Fitting model...  29.3%    Fitting model...  29.3%    Fitting model...  29.4%    Fitting model...  29.4%    Fitting model...  29.5%    Fitting model...  29.5%    Fitting model...  29.6%    Fitting model...  29.6%    Fitting model...  29.7%    Fitting model...  29.8%    Fitting model...  29.8%    Fitting model...  29.8%    Fitting model...  29.9%    Fitting model...  29.9%    Fitting model...  30.0%    Fitting model...  30.0%    Fitting model...  30.1%    Fitting model...  30.1%    Fitting model...  30.2%    Fitting model...  30.2%    Fitting model...  30.3%    Fitting model...  30.3%    Fitting model...  30.4%    Fitting model...  30.4%    Fitting model...  30.5%    Fitting model...  30.6%    Fitting model...  30.6%    Fitting model...  30.6%    Fitting model...  30.7%    Fitting model...  30.8%    Fitting model...  30.8%    Fitting model...  30.9%    Fitting model...  30.9%    Fitting model...  30.9%    Fitting model...  31.0%    Fitting model...  31.1%    Fitting model...  31.1%    Fitting model...  31.1%    Fitting model...  31.2%    Fitting model...  31.2%    Fitting model...  31.3%    Fitting model...  31.4%    Fitting model...  31.4%    Fitting model...  31.4%    Fitting model...  31.5%    Fitting model...  31.6%    Fitting model...  31.6%    Fitting model...  31.6%    Fitting model...  31.7%    Fitting model...  31.8%    Fitting model...  31.8%    Fitting model...  31.9%    Fitting model...  31.9%    Fitting model...  31.9%    Fitting model...  32.0%    Fitting model...  32.0%    Fitting model...  32.1%    Fitting model...  32.1%    Fitting model...  32.2%    Fitting model...  32.2%    Fitting model...  32.3%    Fitting model...  32.4%    Fitting model...  32.4%    Fitting model...  32.5%    Fitting model...  32.5%    Fitting model...  32.6%    Fitting model...  32.6%    Fitting model...  32.6%    Fitting model...  32.7%    Fitting model...  32.8%    Fitting model...  32.8%    Fitting model...  32.9%    Fitting model...  32.9%    Fitting model...  33.0%    Fitting model...  33.0%    Fitting model...  33.1%    Fitting model...  33.1%    Fitting model...  33.1%    Fitting model...  33.2%    Fitting model...  33.2%    Fitting model...  33.3%    Fitting model...  33.4%    Fitting model...  33.4%    Fitting model...  33.5%    Fitting model...  33.5%    Fitting model...  33.6%    Fitting model...  33.6%    Fitting model...  33.7%    Fitting model...  33.7%    Fitting model...  33.8%    Fitting model...  33.8%    Fitting model...  33.9%    Fitting model...  33.9%    Fitting model...  34.0%    Fitting model...  34.0%    Fitting model...  34.1%    Fitting model...  34.1%    Fitting model...  34.2%    Fitting model...  34.2%    Fitting model...  34.2%    Fitting model...  34.3%    Fitting model...  34.4%    Fitting model...  34.4%    Fitting model...  34.4%    Fitting model...  34.5%    Fitting model...  34.5%    Fitting model...  34.6%    Fitting model...  34.6%    Fitting model...  34.7%    Fitting model...  34.8%    Fitting model...  34.8%    Fitting model...  34.8%    Fitting model...  34.9%    Fitting model...  34.9%    Fitting model...  35.0%    Fitting model...  35.0%    Fitting model...  35.1%    Fitting model...  35.1%    Fitting model...  35.2%    Fitting model...  35.2%    Fitting model...  35.3%    Fitting model...  35.4%    Fitting model...  35.4%    Fitting model...  35.4%    Fitting model...  35.5%    Fitting model...  35.5%    Fitting model...  35.6%    Fitting model...  35.6%    Fitting model...  35.7%    Fitting model...  35.8%    Fitting model...  35.8%    Fitting model...  35.9%    Fitting model...  35.9%    Fitting model...  35.9%    Fitting model...  36.0%    Fitting model...  36.0%    Fitting model...  36.1%    Fitting model...  36.1%    Fitting model...  36.2%    Fitting model...  36.2%    Fitting model...  36.3%    Fitting model...  36.4%    Fitting model...  36.4%    Fitting model...  36.4%    Fitting model...  36.5%    Fitting model...  36.5%    Fitting model...  36.6%    Fitting model...  36.6%    Fitting model...  36.7%    Fitting model...  36.8%    Fitting model...  36.8%    Fitting model...  36.9%    Fitting model...  36.9%    Fitting model...  37.0%    Fitting model...  37.0%    Fitting model...  37.0%    Fitting model...  37.1%    Fitting model...  37.1%    Fitting model...  37.2%    Fitting model...  37.2%    Fitting model...  37.3%    Fitting model...  37.4%    Fitting model...  37.4%    Fitting model...  37.5%    Fitting model...  37.5%    Fitting model...  37.5%    Fitting model...  37.6%    Fitting model...  37.6%    Fitting model...  37.7%    Fitting model...  37.8%    Fitting model...  37.8%    Fitting model...  37.9%    Fitting model...  37.9%    Fitting model...  38.0%    Fitting model...  38.0%    Fitting model...  38.0%    Fitting model...  38.1%    Fitting model...  38.1%    Fitting model...  38.2%    Fitting model...  38.2%    Fitting model...  38.3%    Fitting model...  38.4%    Fitting model...  38.4%    Fitting model...  38.5%    Fitting model...  38.5%    Fitting model...  38.6%    Fitting model...  38.6%    Fitting model...  38.6%    Fitting model...  38.7%    Fitting model...  38.8%    Fitting model...  38.8%    Fitting model...  38.9%    Fitting model...  38.9%    Fitting model...  39.0%    Fitting model...  39.0%    Fitting model...  39.1%    Fitting model...  39.1%    Fitting model...  39.1%    Fitting model...  39.2%    Fitting model...  39.2%    Fitting model...  39.3%    Fitting model...  39.4%    Fitting model...  39.4%    Fitting model...  39.5%    Fitting model...  39.5%    Fitting model...  39.6%    Fitting model...  39.6%    Fitting model...  39.6%    Fitting model...  39.7%    Fitting model...  39.8%    Fitting model...  39.8%    Fitting model...  39.9%    Fitting model...  39.9%    Fitting model...  40.0%    Fitting model...  40.0%    Fitting model...  40.1%    Fitting model...  40.1%    Fitting model...  40.2%    Fitting model...  40.2%    Fitting model...  40.2%    Fitting model...  40.3%    Fitting model...  40.4%    Fitting model...  40.4%    Fitting model...  40.5%    Fitting model...  40.5%    Fitting model...  40.6%    Fitting model...  40.6%    Fitting model...  40.6%    Fitting model...  40.7%    Fitting model...  40.8%    Fitting model...  40.8%    Fitting model...  40.8%    Fitting model...  40.9%    Fitting model...  40.9%    Fitting model...  41.0%    Fitting model...  41.0%    Fitting model...  41.1%    Fitting model...  41.1%    Fitting model...  41.2%    Fitting model...  41.2%    Fitting model...  41.3%    Fitting model...  41.3%    Fitting model...  41.4%    Fitting model...  41.4%    Fitting model...  41.5%    Fitting model...  41.5%    Fitting model...  41.6%    Fitting model...  41.6%    Fitting model...  41.7%    Fitting model...  41.8%    Fitting model...  41.8%    Fitting model...  41.9%    Fitting model...  41.9%    Fitting model...  41.9%    Fitting model...  42.0%    Fitting model...  42.0%    Fitting model...  42.1%    Fitting model...  42.1%    Fitting model...  42.2%    Fitting model...  42.2%    Fitting model...  42.3%    Fitting model...  42.4%    Fitting model...  42.4%    Fitting model...  42.4%    Fitting model...  42.5%    Fitting model...  42.5%    Fitting model...  42.6%    Fitting model...  42.6%    Fitting model...  42.7%    Fitting model...  42.8%    Fitting model...  42.8%    Fitting model...  42.9%    Fitting model...  42.9%    Fitting model...  43.0%    Fitting model...  43.0%    Fitting model...  43.0%    Fitting model...  43.1%    Fitting model...  43.1%    Fitting model...  43.2%    Fitting model...  43.2%    Fitting model...  43.3%    Fitting model...  43.4%    Fitting model...  43.4%    Fitting model...  43.5%    Fitting model...  43.5%    Fitting model...  43.5%    Fitting model...  43.6%    Fitting model...  43.6%    Fitting model...  43.7%    Fitting model...  43.8%    Fitting model...  43.8%    Fitting model...  43.9%    Fitting model...  43.9%    Fitting model...  44.0%    Fitting model...  44.0%    Fitting model...  44.0%    Fitting model...  44.1%    Fitting model...  44.1%    Fitting model...  44.2%    Fitting model...  44.2%    Fitting model...  44.3%    Fitting model...  44.4%    Fitting model...  44.4%    Fitting model...  44.5%    Fitting model...  44.5%    Fitting model...  44.5%    Fitting model...  44.6%    Fitting model...  44.6%    Fitting model...  44.7%    Fitting model...  44.8%    Fitting model...  44.8%    Fitting model...  44.9%    Fitting model...  44.9%    Fitting model...  45.0%    Fitting model...  45.0%    Fitting model...  45.1%    Fitting model...  45.1%    Fitting model...  45.1%    Fitting model...  45.2%    Fitting model...  45.2%    Fitting model...  45.3%    Fitting model...  45.4%    Fitting model...  45.4%    Fitting model...  45.5%    Fitting model...  45.5%    Fitting model...  45.6%    Fitting model...  45.6%    Fitting model...  45.6%    Fitting model...  45.7%    Fitting model...  45.8%    Fitting model...  45.8%    Fitting model...  45.9%    Fitting model...  45.9%    Fitting model...  46.0%    Fitting model...  46.0%    Fitting model...  46.1%    Fitting model...  46.1%    Fitting model...  46.2%    Fitting model...  46.2%    Fitting model...  46.2%    Fitting model...  46.3%    Fitting model...  46.4%    Fitting model...  46.4%    Fitting model...  46.5%    Fitting model...  46.5%    Fitting model...  46.6%    Fitting model...  46.6%    Fitting model...  46.7%    Fitting model...  46.7%    Fitting model...  46.8%    Fitting model...  46.8%    Fitting model...  46.9%    Fitting model...  46.9%    Fitting model...  46.9%    Fitting model...  47.0%    Fitting model...  47.0%    Fitting model...  47.1%    Fitting model...  47.1%    Fitting model...  47.2%    Fitting model...  47.2%    Fitting model...  47.3%    Fitting model...  47.3%    Fitting model...  47.4%    Fitting model...  47.4%    Fitting model...  47.5%    Fitting model...  47.5%    Fitting model...  47.6%    Fitting model...  47.6%    Fitting model...  47.7%    Fitting model...  47.8%    Fitting model...  47.8%    Fitting model...  47.9%    Fitting model...  47.9%    Fitting model...  47.9%    Fitting model...  48.0%    Fitting model...  48.0%    Fitting model...  48.1%    Fitting model...  48.1%    Fitting model...  48.2%    Fitting model...  48.2%    Fitting model...  48.3%    Fitting model...  48.4%    Fitting model...  48.4%    Fitting model...  48.4%    Fitting model...  48.5%    Fitting model...  48.5%    Fitting model...  48.6%    Fitting model...  48.6%    Fitting model...  48.7%    Fitting model...  48.8%    Fitting model...  48.8%    Fitting model...  48.9%    Fitting model...  48.9%    Fitting model...  48.9%    Fitting model...  49.0%    Fitting model...  49.0%    Fitting model...  49.1%    Fitting model...  49.1%    Fitting model...  49.2%    Fitting model...  49.2%    Fitting model...  49.3%    Fitting model...  49.4%    Fitting model...  49.4%    Fitting model...  49.5%    Fitting model...  49.5%    Fitting model...  49.5%    Fitting model...  49.6%    Fitting model...  49.6%    Fitting model...  49.7%    Fitting model...  49.8%    Fitting model...  49.8%    Fitting model...  49.9%    Fitting model...  49.9%    Fitting model...  50.0%    Fitting model...  50.0%    Fitting model...  50.0%    Fitting model...  50.1%    Fitting model...  50.1%    Fitting model...  50.2%    Fitting model...  50.2%    Fitting model...  50.3%    Fitting model...  50.3%    Fitting model...  50.4%    Fitting model...  50.4%    Fitting model...  50.5%    Fitting model...  50.5%    Fitting model...  50.6%    Fitting model...  50.6%    Fitting model...  50.7%    Fitting model...  50.7%    Fitting model...  50.8%    Fitting model...  50.8%    Fitting model...  50.9%    Fitting model...  50.9%    Fitting model...  51.0%    Fitting model...  51.0%    Fitting model...  51.1%    Fitting model...  51.1%    Fitting model...  51.2%    Fitting model...  51.2%    Fitting model...  51.3%    Fitting model...  51.3%    Fitting model...  51.4%    Fitting model...  51.4%    Fitting model...  51.5%    Fitting model...  51.5%    Fitting model...  51.6%    Fitting model...  51.6%    Fitting model...  51.7%    Fitting model...  51.7%    Fitting model...  51.8%    Fitting model...  51.8%    Fitting model...  51.9%    Fitting model...  51.9%    Fitting model...  52.0%    Fitting model...  52.0%    Fitting model...  52.1%    Fitting model...  52.1%    Fitting model...  52.2%    Fitting model...  52.2%    Fitting model...  52.3%    Fitting model...  52.3%    Fitting model...  52.4%    Fitting model...  52.4%    Fitting model...  52.5%    Fitting model...  52.5%    Fitting model...  52.6%    Fitting model...  52.6%    Fitting model...  52.7%    Fitting model...  52.8%    Fitting model...  52.8%    Fitting model...  52.8%    Fitting model...  52.9%    Fitting model...  52.9%    Fitting model...  53.0%    Fitting model...  53.0%    Fitting model...  53.1%    Fitting model...  53.1%    Fitting model...  53.2%    Fitting model...  53.2%    Fitting model...  53.3%    Fitting model...  53.3%    Fitting model...  53.4%    Fitting model...  53.4%    Fitting model...  53.5%    Fitting model...  53.5%    Fitting model...  53.6%    Fitting model...  53.6%    Fitting model...  53.7%    Fitting model...  53.8%    Fitting model...  53.8%    Fitting model...  53.8%    Fitting model...  53.9%    Fitting model...  53.9%    Fitting model...  54.0%    Fitting model...  54.0%    Fitting model...  54.1%    Fitting model...  54.1%    Fitting model...  54.2%    Fitting model...  54.2%    Fitting model...  54.3%    Fitting model...  54.4%    Fitting model...  54.4%    Fitting model...  54.4%    Fitting model...  54.5%    Fitting model...  54.5%    Fitting model...  54.6%    Fitting model...  54.6%    Fitting model...  54.7%    Fitting model...  54.8%    Fitting model...  54.8%    Fitting model...  54.9%    Fitting model...  54.9%    Fitting model...  54.9%    Fitting model...  55.0%    Fitting model...  55.0%    Fitting model...  55.1%    Fitting model...  55.1%    Fitting model...  55.2%    Fitting model...  55.2%    Fitting model...  55.3%    Fitting model...  55.4%    Fitting model...  55.4%    Fitting model...  55.5%    Fitting model...  55.5%    Fitting model...  55.5%    Fitting model...  55.6%    Fitting model...  55.6%    Fitting model...  55.7%    Fitting model...  55.8%    Fitting model...  55.8%    Fitting model...  55.9%    Fitting model...  55.9%    Fitting model...  56.0%    Fitting model...  56.0%    Fitting model...  56.0%    Fitting model...  56.1%    Fitting model...  56.1%    Fitting model...  56.2%    Fitting model...  56.2%    Fitting model...  56.3%    Fitting model...  56.4%    Fitting model...  56.4%    Fitting model...  56.5%    Fitting model...  56.5%    Fitting model...  56.5%    Fitting model...  56.6%    Fitting model...  56.6%    Fitting model...  56.7%    Fitting model...  56.8%    Fitting model...  56.8%    Fitting model...  56.9%    Fitting model...  56.9%    Fitting model...  57.0%    Fitting model...  57.0%    Fitting model...  57.0%    Fitting model...  57.1%    Fitting model...  57.1%    Fitting model...  57.2%    Fitting model...  57.2%    Fitting model...  57.3%    Fitting model...  57.4%    Fitting model...  57.4%    Fitting model...  57.5%    Fitting model...  57.5%    Fitting model...  57.6%    Fitting model...  57.6%    Fitting model...  57.6%    Fitting model...  57.7%    Fitting model...  57.8%    Fitting model...  57.8%    Fitting model...  57.9%    Fitting model...  57.9%    Fitting model...  58.0%    Fitting model...  58.0%    Fitting model...  58.1%    Fitting model...  58.1%    Fitting model...  58.1%    Fitting model...  58.2%    Fitting model...  58.2%    Fitting model...  58.3%    Fitting model...  58.4%    Fitting model...  58.4%    Fitting model...  58.5%    Fitting model...  58.5%    Fitting model...  58.6%    Fitting model...  58.6%    Fitting model...  58.7%    Fitting model...  58.7%    Fitting model...  58.8%    Fitting model...  58.8%    Fitting model...  58.9%    Fitting model...  58.9%    Fitting model...  59.0%    Fitting model...  59.0%    Fitting model...  59.1%    Fitting model...  59.1%    Fitting model...  59.2%    Fitting model...  59.2%    Fitting model...  59.2%    Fitting model...  59.3%    Fitting model...  59.4%    Fitting model...  59.4%    Fitting model...  59.5%    Fitting model...  59.5%    Fitting model...  59.6%    Fitting model...  59.6%    Fitting model...  59.7%    Fitting model...  59.7%    Fitting model...  59.8%    Fitting model...  59.8%    Fitting model...  59.9%    Fitting model...  59.9%    Fitting model...  60.0%    Fitting model...  60.0%    Fitting model...  60.1%    Fitting model...  60.1%    Fitting model...  60.2%    Fitting model...  60.2%    Fitting model...  60.2%    Fitting model...  60.3%    Fitting model...  60.4%    Fitting model...  60.4%    Fitting model...  60.5%    Fitting model...  60.5%    Fitting model...  60.6%    Fitting model...  60.6%    Fitting model...  60.7%    Fitting model...  60.7%    Fitting model...  60.8%    Fitting model...  60.8%    Fitting model...  60.9%    Fitting model...  60.9%    Fitting model...  61.0%    Fitting model...  61.0%    Fitting model...  61.1%    Fitting model...  61.1%    Fitting model...  61.2%    Fitting model...  61.2%    Fitting model...  61.3%    Fitting model...  61.3%    Fitting model...  61.4%    Fitting model...  61.4%    Fitting model...  61.5%    Fitting model...  61.5%    Fitting model...  61.6%    Fitting model...  61.6%    Fitting model...  61.7%    Fitting model...  61.7%    Fitting model...  61.8%    Fitting model...  61.8%    Fitting model...  61.9%    Fitting model...  61.9%    Fitting model...  62.0%    Fitting model...  62.0%    Fitting model...  62.1%    Fitting model...  62.1%    Fitting model...  62.2%    Fitting model...  62.2%    Fitting model...  62.3%    Fitting model...  62.3%    Fitting model...  62.4%    Fitting model...  62.4%    Fitting model...  62.5%    Fitting model...  62.5%    Fitting model...  62.5%    Fitting model...  62.6%    Fitting model...  62.6%    Fitting model...  62.7%    Fitting model...  62.7%    Fitting model...  62.8%    Fitting model...  62.8%    Fitting model...  62.9%    Fitting model...  62.9%    Fitting model...  63.0%    Fitting model...  63.0%    Fitting model...  63.1%    Fitting model...  63.1%    Fitting model...  63.2%    Fitting model...  63.2%    Fitting model...  63.3%    Fitting model...  63.3%    Fitting model...  63.4%    Fitting model...  63.4%    Fitting model...  63.5%    Fitting model...  63.5%    Fitting model...  63.6%    Fitting model...  63.6%    Fitting model...  63.7%    Fitting model...  63.7%    Fitting model...  63.8%    Fitting model...  63.8%    Fitting model...  63.9%    Fitting model...  63.9%    Fitting model...  64.0%    Fitting model...  64.0%    Fitting model...  64.1%    Fitting model...  64.1%    Fitting model...  64.2%    Fitting model...  64.2%    Fitting model...  64.3%    Fitting model...  64.3%    Fitting model...  64.4%    Fitting model...  64.5%    Fitting model...  64.5%    Fitting model...  64.5%    Fitting model...  64.6%    Fitting model...  64.6%    Fitting model...  64.7%    Fitting model...  64.8%    Fitting model...  64.8%    Fitting model...  64.8%    Fitting model...  64.9%    Fitting model...  65.0%    Fitting model...  65.0%    Fitting model...  65.0%    Fitting model...  65.1%    Fitting model...  65.1%    Fitting model...  65.2%    Fitting model...  65.2%    Fitting model...  65.3%    Fitting model...  65.3%    Fitting model...  65.4%    Fitting model...  65.5%    Fitting model...  65.5%    Fitting model...  65.5%    Fitting model...  65.6%    Fitting model...  65.6%    Fitting model...  65.7%    Fitting model...  65.8%    Fitting model...  65.8%    Fitting model...  65.8%    Fitting model...  65.9%    Fitting model...  66.0%    Fitting model...  66.0%    Fitting model...  66.0%    Fitting model...  66.1%    Fitting model...  66.1%    Fitting model...  66.2%    Fitting model...  66.2%    Fitting model...  66.3%    Fitting model...  66.3%    Fitting model...  66.4%    Fitting model...  66.5%    Fitting model...  66.5%    Fitting model...  66.5%    Fitting model...  66.6%    Fitting model...  66.6%    Fitting model...  66.7%    Fitting model...  66.8%    Fitting model...  66.8%    Fitting model...  66.8%    Fitting model...  66.9%    Fitting model...  67.0%    Fitting model...  67.0%    Fitting model...  67.0%    Fitting model...  67.1%    Fitting model...  67.2%    Fitting model...  67.2%    Fitting model...  67.2%    Fitting model...  67.3%    Fitting model...  67.3%    Fitting model...  67.4%    Fitting model...  67.5%    Fitting model...  67.5%    Fitting model...  67.5%    Fitting model...  67.6%    Fitting model...  67.7%    Fitting model...  67.7%    Fitting model...  67.8%    Fitting model...  67.8%    Fitting model...  67.8%    Fitting model...  67.9%    Fitting model...  68.0%    Fitting model...  68.0%    Fitting model...  68.0%    Fitting model...  68.1%    Fitting model...  68.2%    Fitting model...  68.2%    Fitting model...  68.2%    Fitting model...  68.3%    Fitting model...  68.3%    Fitting model...  68.4%    Fitting model...  68.5%    Fitting model...  68.5%    Fitting model...  68.5%    Fitting model...  68.6%    Fitting model...  68.7%    Fitting model...  68.7%    Fitting model...  68.8%    Fitting model...  68.8%    Fitting model...  68.8%    Fitting model...  68.9%    Fitting model...  69.0%    Fitting model...  69.0%    Fitting model...  69.0%    Fitting model...  69.1%    Fitting model...  69.2%    Fitting model...  69.2%    Fitting model...  69.2%    Fitting model...  69.3%    Fitting model...  69.3%    Fitting model...  69.4%    Fitting model...  69.5%    Fitting model...  69.5%    Fitting model...  69.5%    Fitting model...  69.6%    Fitting model...  69.7%    Fitting model...  69.7%    Fitting model...  69.8%    Fitting model...  69.8%    Fitting model...  69.8%    Fitting model...  69.9%    Fitting model...  70.0%    Fitting model...  70.0%    Fitting model...  70.0%    Fitting model...  70.1%    Fitting model...  70.2%    Fitting model...  70.2%    Fitting model...  70.2%    Fitting model...  70.3%    Fitting model...  70.3%    Fitting model...  70.4%    Fitting model...  70.5%    Fitting model...  70.5%    Fitting model...  70.5%    Fitting model...  70.6%    Fitting model...  70.7%    Fitting model...  70.7%    Fitting model...  70.8%    Fitting model...  70.8%    Fitting model...  70.9%    Fitting model...  70.9%    Fitting model...  71.0%    Fitting model...  71.0%    Fitting model...  71.0%    Fitting model...  71.1%    Fitting model...  71.2%    Fitting model...  71.2%    Fitting model...  71.2%    Fitting model...  71.3%    Fitting model...  71.4%    Fitting model...  71.4%    Fitting model...  71.5%    Fitting model...  71.5%    Fitting model...  71.5%    Fitting model...  71.6%    Fitting model...  71.7%    Fitting model...  71.7%    Fitting model...  71.8%    Fitting model...  71.8%    Fitting model...  71.9%    Fitting model...  71.9%    Fitting model...  72.0%    Fitting model...  72.0%    Fitting model...  72.0%    Fitting model...  72.1%    Fitting model...  72.2%    Fitting model...  72.2%    Fitting model...  72.2%    Fitting model...  72.3%    Fitting model...  72.4%    Fitting model...  72.4%    Fitting model...  72.5%    Fitting model...  72.5%    Fitting model...  72.5%    Fitting model...  72.6%    Fitting model...  72.7%    Fitting model...  72.7%    Fitting model...  72.8%    Fitting model...  72.8%    Fitting model...  72.9%    Fitting model...  72.9%    Fitting model...  73.0%    Fitting model...  73.0%    Fitting model...  73.0%    Fitting model...  73.1%    Fitting model...  73.2%    Fitting model...  73.2%    Fitting model...  73.2%    Fitting model...  73.3%    Fitting model...  73.4%    Fitting model...  73.4%    Fitting model...  73.5%    Fitting model...  73.5%    Fitting model...  73.6%    Fitting model...  73.6%    Fitting model...  73.7%    Fitting model...  73.7%    Fitting model...  73.8%    Fitting model...  73.8%    Fitting model...  73.9%    Fitting model...  73.9%    Fitting model...  74.0%    Fitting model...  74.0%    Fitting model...  74.1%    Fitting model...  74.1%    Fitting model...  74.2%    Fitting model...  74.2%    Fitting model...  74.2%    Fitting model...  74.3%    Fitting model...  74.4%    Fitting model...  74.4%    Fitting model...  74.5%    Fitting model...  74.5%    Fitting model...  74.6%    Fitting model...  74.6%    Fitting model...  74.7%    Fitting model...  74.7%    Fitting model...  74.8%    Fitting model...  74.8%    Fitting model...  74.9%    Fitting model...  74.9%    Fitting model...  75.0%    Fitting model...  75.0%    Fitting model...  75.0%    Fitting model...  75.1%    Fitting model...  75.1%    Fitting model...  75.2%    Fitting model...  75.2%    Fitting model...  75.3%    Fitting model...  75.3%    Fitting model...  75.4%    Fitting model...  75.4%    Fitting model...  75.5%    Fitting model...  75.5%    Fitting model...  75.6%    Fitting model...  75.6%    Fitting model...  75.7%    Fitting model...  75.8%    Fitting model...  75.8%    Fitting model...  75.8%    Fitting model...  75.9%    Fitting model...  75.9%    Fitting model...  76.0%    Fitting model...  76.0%    Fitting model...  76.1%    Fitting model...  76.1%    Fitting model...  76.2%    Fitting model...  76.2%    Fitting model...  76.3%    Fitting model...  76.3%    Fitting model...  76.4%    Fitting model...  76.4%    Fitting model...  76.5%    Fitting model...  76.5%    Fitting model...  76.6%    Fitting model...  76.6%    Fitting model...  76.7%    Fitting model...  76.8%    Fitting model...  76.8%    Fitting model...  76.8%    Fitting model...  76.9%    Fitting model...  77.0%    Fitting model...  77.0%    Fitting model...  77.0%    Fitting model...  77.1%    Fitting model...  77.1%    Fitting model...  77.2%    Fitting model...  77.2%    Fitting model...  77.3%    Fitting model...  77.3%    Fitting model...  77.4%    Fitting model...  77.5%    Fitting model...  77.5%    Fitting model...  77.5%    Fitting model...  77.6%    Fitting model...  77.6%    Fitting model...  77.7%    Fitting model...  77.8%    Fitting model...  77.8%    Fitting model...  77.8%    Fitting model...  77.9%    Fitting model...  78.0%    Fitting model...  78.0%    Fitting model...  78.0%    Fitting model...  78.1%    Fitting model...  78.1%    Fitting model...  78.2%    Fitting model...  78.2%    Fitting model...  78.3%    Fitting model...  78.3%    Fitting model...  78.4%    Fitting model...  78.5%    Fitting model...  78.5%    Fitting model...  78.5%    Fitting model...  78.6%    Fitting model...  78.6%    Fitting model...  78.7%    Fitting model...  78.8%    Fitting model...  78.8%    Fitting model...  78.8%    Fitting model...  78.9%    Fitting model...  79.0%    Fitting model...  79.0%    Fitting model...  79.0%    Fitting model...  79.1%    Fitting model...  79.1%    Fitting model...  79.2%    Fitting model...  79.2%    Fitting model...  79.3%    Fitting model...  79.3%    Fitting model...  79.4%    Fitting model...  79.5%    Fitting model...  79.5%    Fitting model...  79.5%    Fitting model...  79.6%    Fitting model...  79.7%    Fitting model...  79.7%    Fitting model...  79.8%    Fitting model...  79.8%    Fitting model...  79.8%    Fitting model...  79.9%    Fitting model...  80.0%    Fitting model...  80.0%    Fitting model...  80.0%    Fitting model...  80.1%    Fitting model...  80.2%    Fitting model...  80.2%    Fitting model...  80.2%    Fitting model...  80.3%    Fitting model...  80.3%    Fitting model...  80.4%    Fitting model...  80.5%    Fitting model...  80.5%    Fitting model...  80.5%    Fitting model...  80.6%    Fitting model...  80.7%    Fitting model...  80.7%    Fitting model...  80.8%    Fitting model...  80.8%    Fitting model...  80.8%    Fitting model...  80.9%    Fitting model...  81.0%    Fitting model...  81.0%    Fitting model...  81.0%    Fitting model...  81.1%    Fitting model...  81.2%    Fitting model...  81.2%    Fitting model...  81.2%    Fitting model...  81.3%    Fitting model...  81.3%    Fitting model...  81.4%    Fitting model...  81.5%    Fitting model...  81.5%    Fitting model...  81.5%    Fitting model...  81.6%    Fitting model...  81.7%    Fitting model...  81.7%    Fitting model...  81.8%    Fitting model...  81.8%    Fitting model...  81.8%    Fitting model...  81.9%    Fitting model...  82.0%    Fitting model...  82.0%    Fitting model...  82.0%    Fitting model...  82.1%    Fitting model...  82.2%    Fitting model...  82.2%    Fitting model...  82.2%    Fitting model...  82.3%    Fitting model...  82.3%    Fitting model...  82.4%    Fitting model...  82.5%    Fitting model...  82.5%    Fitting model...  82.5%    Fitting model...  82.6%    Fitting model...  82.7%    Fitting model...  82.7%    Fitting model...  82.8%    Fitting model...  82.8%    Fitting model...  82.8%    Fitting model...  82.9%    Fitting model...  83.0%    Fitting model...  83.0%    Fitting model...  83.0%    Fitting model...  83.1%    Fitting model...  83.2%    Fitting model...  83.2%    Fitting model...  83.2%    Fitting model...  83.3%    Fitting model...  83.4%    Fitting model...  83.4%    Fitting model...  83.5%    Fitting model...  83.5%    Fitting model...  83.5%    Fitting model...  83.6%    Fitting model...  83.7%    Fitting model...  83.7%    Fitting model...  83.8%    Fitting model...  83.8%    Fitting model...  83.9%    Fitting model...  83.9%    Fitting model...  84.0%    Fitting model...  84.0%    Fitting model...  84.0%    Fitting model...  84.1%    Fitting model...  84.2%    Fitting model...  84.2%    Fitting model...  84.2%    Fitting model...  84.3%    Fitting model...  84.4%    Fitting model...  84.4%    Fitting model...  84.5%    Fitting model...  84.5%    Fitting model...  84.5%    Fitting model...  84.6%    Fitting model...  84.7%    Fitting model...  84.7%    Fitting model...  84.8%    Fitting model...  84.8%    Fitting model...  84.9%    Fitting model...  84.9%    Fitting model...  85.0%    Fitting model...  85.0%    Fitting model...  85.0%    Fitting model...  85.1%    Fitting model...  85.2%    Fitting model...  85.2%    Fitting model...  85.2%    Fitting model...  85.3%    Fitting model...  85.4%    Fitting model...  85.4%    Fitting model...  85.5%    Fitting model...  85.5%    Fitting model...  85.5%    Fitting model...  85.6%    Fitting model...  85.7%    Fitting model...  85.7%    Fitting model...  85.8%    Fitting model...  85.8%    Fitting model...  85.9%    Fitting model...  85.9%    Fitting model...  86.0%    Fitting model...  86.0%    Fitting model...  86.1%    Fitting model...  86.1%    Fitting model...  86.2%    Fitting model...  86.2%    Fitting model...  86.2%    Fitting model...  86.3%    Fitting model...  86.4%    Fitting model...  86.4%    Fitting model...  86.5%    Fitting model...  86.5%    Fitting model...  86.6%    Fitting model...  86.6%    Fitting model...  86.7%    Fitting model...  86.7%    Fitting model...  86.8%    Fitting model...  86.8%    Fitting model...  86.9%    Fitting model...  86.9%    Fitting model...  87.0%    Fitting model...  87.0%    Fitting model...  87.1%    Fitting model...  87.1%    Fitting model...  87.2%    Fitting model...  87.2%    Fitting model...  87.2%    Fitting model...  87.3%    Fitting model...  87.4%    Fitting model...  87.4%    Fitting model...  87.5%    Fitting model...  87.5%    Fitting model...  87.5%    Fitting model...  87.6%    Fitting model...  87.6%    Fitting model...  87.7%    Fitting model...  87.8%    Fitting model...  87.8%    Fitting model...  87.8%    Fitting model...  87.9%    Fitting model...  87.9%    Fitting model...  88.0%    Fitting model...  88.0%    Fitting model...  88.1%    Fitting model...  88.1%    Fitting model...  88.2%    Fitting model...  88.2%    Fitting model...  88.3%    Fitting model...  88.3%    Fitting model...  88.4%    Fitting model...  88.4%    Fitting model...  88.5%    Fitting model...  88.5%    Fitting model...  88.6%    Fitting model...  88.6%    Fitting model...  88.7%    Fitting model...  88.8%    Fitting model...  88.8%    Fitting model...  88.8%    Fitting model...  88.9%    Fitting model...  88.9%    Fitting model...  89.0%    Fitting model...  89.0%    Fitting model...  89.1%    Fitting model...  89.1%    Fitting model...  89.2%    Fitting model...  89.2%    Fitting model...  89.3%    Fitting model...  89.3%    Fitting model...  89.4%    Fitting model...  89.5%    Fitting model...  89.5%    Fitting model...  89.5%    Fitting model...  89.6%    Fitting model...  89.6%    Fitting model...  89.7%    Fitting model...  89.8%    Fitting model...  89.8%    Fitting model...  89.8%    Fitting model...  89.9%    Fitting model...  90.0%    Fitting model...  90.0%    Fitting model...  90.0%    Fitting model...  90.1%    Fitting model...  90.1%    Fitting model...  90.2%    Fitting model...  90.2%    Fitting model...  90.3%    Fitting model...  90.3%    Fitting model...  90.4%    Fitting model...  90.5%    Fitting model...  90.5%    Fitting model...  90.5%    Fitting model...  90.6%    Fitting model...  90.6%    Fitting model...  90.7%    Fitting model...  90.8%    Fitting model...  90.8%    Fitting model...  90.8%    Fitting model...  90.9%    Fitting model...  91.0%    Fitting model...  91.0%    Fitting model...  91.0%    Fitting model...  91.1%    Fitting model...  91.1%    Fitting model...  91.2%    Fitting model...  91.2%    Fitting model...  91.3%    Fitting model...  91.3%    Fitting model...  91.4%    Fitting model...  91.5%    Fitting model...  91.5%    Fitting model...  91.5%    Fitting model...  91.6%    Fitting model...  91.6%    Fitting model...  91.7%    Fitting model...  91.8%    Fitting model...  91.8%    Fitting model...  91.8%    Fitting model...  91.9%    Fitting model...  92.0%    Fitting model...  92.0%    Fitting model...  92.0%    Fitting model...  92.1%    Fitting model...  92.2%    Fitting model...  92.2%    Fitting model...  92.2%    Fitting model...  92.3%    Fitting model...  92.3%    Fitting model...  92.4%    Fitting model...  92.5%    Fitting model...  92.5%    Fitting model...  92.5%    Fitting model...  92.6%    Fitting model...  92.7%    Fitting model...  92.7%    Fitting model...  92.8%    Fitting model...  92.8%    Fitting model...  92.8%    Fitting model...  92.9%    Fitting model...  93.0%    Fitting model...  93.0%    Fitting model...  93.0%    Fitting model...  93.1%    Fitting model...  93.2%    Fitting model...  93.2%    Fitting model...  93.2%    Fitting model...  93.3%    Fitting model...  93.3%    Fitting model...  93.4%    Fitting model...  93.5%    Fitting model...  93.5%    Fitting model...  93.5%    Fitting model...  93.6%    Fitting model...  93.7%    Fitting model...  93.7%    Fitting model...  93.8%    Fitting model...  93.8%    Fitting model...  93.8%    Fitting model...  93.9%    Fitting model...  94.0%    Fitting model...  94.0%    Fitting model...  94.0%    Fitting model...  94.1%    Fitting model...  94.2%    Fitting model...  94.2%    Fitting model...  94.2%    Fitting model...  94.3%    Fitting model...  94.3%    Fitting model...  94.4%    Fitting model...  94.5%    Fitting model...  94.5%    Fitting model...  94.5%    Fitting model...  94.6%    Fitting model...  94.7%    Fitting model...  94.7%    Fitting model...  94.8%    Fitting model...  94.8%    Fitting model...  94.8%    Fitting model...  94.9%    Fitting model...  95.0%    Fitting model...  95.0%    Fitting model...  95.0%    Fitting model...  95.1%    Fitting model...  95.2%    Fitting model...  95.2%    Fitting model...  95.2%    Fitting model...  95.3%    Fitting model...  95.3%    Fitting model...  95.4%    Fitting model...  95.5%    Fitting model...  95.5%    Fitting model...  95.5%    Fitting model...  95.6%    Fitting model...  95.7%    Fitting model...  95.7%    Fitting model...  95.8%    Fitting model...  95.8%    Fitting model...  95.9%    Fitting model...  95.9%    Fitting model...  96.0%    Fitting model...  96.0%    Fitting model...  96.0%    Fitting model...  96.1%    Fitting model...  96.2%    Fitting model...  96.2%    Fitting model...  96.2%    Fitting model...  96.3%    Fitting model...  96.4%    Fitting model...  96.4%    Fitting model...  96.5%    Fitting model...  96.5%    Fitting model...  96.5%    Fitting model...  96.6%    Fitting model...  96.7%    Fitting model...  96.7%    Fitting model...  96.8%    Fitting model...  96.8%    Fitting model...  96.9%    Fitting model...  96.9%    Fitting model...  97.0%    Fitting model...  97.0%    Fitting model...  97.0%    Fitting model...  97.1%    Fitting model...  97.2%    Fitting model...  97.2%    Fitting model...  97.2%    Fitting model...  97.3%    Fitting model...  97.4%    Fitting model...  97.4%    Fitting model...  97.5%    Fitting model...  97.5%    Fitting model...  97.5%    Fitting model...  97.6%    Fitting model...  97.7%    Fitting model...  97.7%    Fitting model...  97.8%    Fitting model...  97.8%    Fitting model...  97.9%    Fitting model...  97.9%    Fitting model...  98.0%    Fitting model...  98.0%    Fitting model...  98.0%    Fitting model...  98.1%    Fitting model...  98.2%    Fitting model...  98.2%    Fitting model...  98.2%    Fitting model...  98.3%    Fitting model...  98.4%    Fitting model...  98.4%    Fitting model...  98.5%    Fitting model...  98.5%    Fitting model...  98.6%    Fitting model...  98.6%    Fitting model...  98.7%    Fitting model...  98.7%    Fitting model...  98.8%    Fitting model...  98.8%    Fitting model...  98.9%    Fitting model...  98.9%    Fitting model...  99.0%    Fitting model...  99.0%    Fitting model...  99.1%    Fitting model...  99.1%    Fitting model...  99.2%    Fitting model...  99.2%    Fitting model...  99.2%    Fitting model...  99.3%    Fitting model...  99.4%    Fitting model...  99.4%    Fitting model...  99.5%    Fitting model...  99.5%    Fitting model...  99.6%    Fitting model...  99.6%    Fitting model...  99.7%    Fitting model...  99.7%    Fitting model...  99.8%    Fitting model...  99.8%    Fitting model...  99.9%    Fitting model...  99.9%    Fitting model... 100.0%    iterations in  3.8175885677337646

    <fadin.solver.UNHaP object at 0x7f4e6bc81640>



.. GENERATED FROM PYTHON SOURCE LINES 80-99

.. code-block:: Python


    print("Estimated baseline is: ", solver.baseline_.item())
    print("Estimated alpha is: ", solver.alpha_.item())
    print("Estimated kernel mean is: ", solver.kernel_[0].item())
    print("Estimated kernel sd is: ", solver.kernel_[1].item())
    print("Estimated noise baseline is: ", solver.baseline_noise_.item())
    # error on params
    error_bl = (solver.baseline_.item() - baseline.item()) ** 2
    error_bl_noise = (
        solver.baseline_noise_.item() - baseline_noise.item()
    ) ** 2
    error_alpha = (solver.alpha_.item() - alpha.item()) ** 2
    error_mu = (solver.kernel_[0].item() - mu.item()) ** 2
    error_sigma = (solver.kernel_[1].item() - sigma.item()) ** 2
    sum_error = error_bl + error_bl_noise + error_alpha + error_mu + error_sigma
    error_params = np.sqrt(sum_error)

    print("L2 square error of the vector of parameters is:", error_params)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Estimated baseline is:  0.3127627372741699
    Estimated alpha is:  1.3615236282348633
    Estimated kernel mean is:  0.4037073254585266
    Estimated kernel sd is:  0.10070288926362991
    Estimated noise baseline is:  0.47099992632865906
    L2 square error of the vector of parameters is: 0.4304022910110504




.. GENERATED FROM PYTHON SOURCE LINES 100-108

.. code-block:: Python

    fig, axs = plot(
        solver,
        plotfig=False,
        bl_noise=True,
        title="UNHaP fit",
        savefig=None
    )
    plt.show(block=True)



.. image-sg:: /auto_examples/images/sphx_glr_plot_unhap_001.png
   :alt: UNHaP fit, 0-> 0
   :srcset: /auto_examples/images/sphx_glr_plot_unhap_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 5.542 seconds)


.. _sphx_glr_download_auto_examples_plot_unhap.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_unhap.ipynb <plot_unhap.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_unhap.py <plot_unhap.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_unhap.zip <plot_unhap.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
